import streamlit as st
import pandas as pd
from statsmodels.tsa.arima.model import ARIMA
from pmdarima import auto_arima
from datetime import datetime, timedelta

# Function to load and preprocess data
def load_and_preprocess_data(file_path):
    df = pd.read_csv(file_path)
    df['datum'] = pd.to_datetime(df['datum'])
    df.set_index('datum', inplace=True)
    df.sort_index(inplace=True)
    return df

# Streamlit app
def main():
    # Add a title with some style
    st.image("data:image/jpeg;base64,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", width=500)  # Adjust width as needed
    st.title("🌟 Pharma Sales Forecasting App 🌟")
    st.subheader("Make data-driven decisions for your pharmaceutical products!")

    # Set background color
    st.markdown(
        """
        <style>
        body {
            background-color: #f4f4f4;
        }
        </style>
        """,
        unsafe_allow_html=True
    )

    # Sidebar for user inputs
    forecasting_frequency = st.sidebar.radio("Select Forecasting Frequency", ["Hourly", "Daily", "Weekly", "Monthly"])
    product_name = st.sidebar.selectbox("Select Product", ["M01AB", "M01AE", "N02BA", "N02BE", "N05B", "N05C", "R03", "R06"])
    num_intervals = st.sidebar.slider("Select Number of Intervals for Forecasting", min_value=1, max_value=30, value=7)

    start_date = st.sidebar.date_input("Select Start Date", datetime.today() - timedelta(days=365))
    end_date = st.sidebar.date_input("Select End Date", datetime.today())

    if start_date >= end_date:
        st.error("End date must be after start date.")
        return

    # Style the button
    generate_button = st.sidebar.button("Generate Forecast", key="generate_button")
    if generate_button:
        st.sidebar.success("Forecast generated successfully!")

    # Determine the dataset based on the selected frequency
    if forecasting_frequency == "Hourly":
        dataset_name = "saleshourly.csv"
    elif forecasting_frequency == "Daily":
        dataset_name = "salesdaily.csv"
    elif forecasting_frequency == "Weekly":
        dataset_name = "salesweekly.csv"
    elif forecasting_frequency == "Monthly":
        dataset_name = "salesmonthly.csv"
    else:
        st.error("Invalid forecasting frequency selected")
        return

    # Load the specific dataset based on the user's selection
    file_path = dataset_name
    df = load_and_preprocess_data(file_path)

    # Filter data based on selected date range
    df_filtered = df[(df.index >= start_date) & (df.index <= end_date)]

    # Train Auto-ARIMA model for short-term forecasting
    model_autoarima = auto_arima(df_filtered[product_name], seasonal=True, m=12)  # Adjust seasonality as needed
    model_autoarima.fit(df_filtered[product_name])

    # Generate future date range based on user input
    freq_mapping = {"Hourly": "H", "Daily": "D", "Weekly": "W", "Monthly": "M"}
    freq = freq_mapping.get(forecasting_frequency, "D")  # Default to Daily if not found
    future_dates = pd.date_range(df_filtered.index[-1] + timedelta(hours=1), periods=num_intervals, freq=freq)

    # Predict sales for the future date range using Auto-ARIMA
    predictions = model_autoarima.predict(n_periods=num_intervals, return_conf_int=False)

    # Create a DataFrame for visualization
    forecast_df = pd.DataFrame({"Date": future_dates, "Predicted Sales": predictions})
    forecast_df.set_index("Date", inplace=True)

    # Display the forecast
    st.subheader(f"Sales Forecast for {product_name} - {forecasting_frequency} Forecasting")
    st.line_chart(forecast_df)

if __name__ == "__main__":
    main()




